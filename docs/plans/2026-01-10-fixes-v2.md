# Fixes Implementation Plan (v2)

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Resolve build errors, fix failing tests, verify IndexedDB connectivity, and repair broken UI interactivity.

**Architecture:** React/Vite/IndexedDB

**Tech Stack:** TypeScript, React, Vitest

---

### Task 1: Fix Core Infrastructure (IndexedDB)

**Files:**
- Modify: `src/services/indexedDb.ts`

**Step 1: Increase Timeout & Debug**
- Issue: `IndexedDB init timed out` prevents app from loading data properly.
- Fix: Increase timeout from 3000ms to 5000ms. Add detailed logging to `onblocked` and `onerror`.
- Validate: Check console for success message instead of timeout.

---

### Task 2: Fix Build Errors (Null Safety)

**Files:**
- Modify: `src/components/dashboard/IconSidebar.tsx`
- Modify: `src/services/profileService.ts`

**Step 1: Fix `IconSidebar.tsx`**
- Fix: Remove unused `useTheme` destructuring to fix TS6198.

**Step 2: Fix `profileService.ts`**
- Fix: Add optional chaining/null checks for `supabase` client.

---

### Task 3: Fix Landing Page Test & Video

**Files:**
- Modify: `src/pages/__tests__/LandingPage.test.tsx`
- Modify: `src/components/layout/HeroSection.tsx` (or wherever video is)

**Step 1: Unify Video Path**
- Identify correct video file (`Logo.mp4` vs `Logo_final.mp4`).
- Update `HeroSection` and Test to match the *actual* existing file.

---

### Task 4: Fix UI Interactivity (Filters & Collections)

**Files:**
- Modify: `src/components/FilterBar.tsx`
- Modify: `src/pages/Collections.tsx`
- Modify: `src/components/collections/CollectionsSidebar.tsx`

**Step 1: Wire Up Filters**
- Check `onClick` handlers in `FilterBar`. If missing, verify props are passed from `Home` page.
- Ensure `onFilterChange` is called.

**Step 2: Connect Collection Store**
- Ensure `handleCreateCollection` in `Collections.tsx` works (depends on IndexedDB fix).
- Check `CollectionsSidebar` button wiring.

---

### Task 5: Final Verification
- Run `npm run build` (Must pass).
- Run `npm run test` (Must pass).
- Browser Audit: Verify Filters, Video, and Collection Creation work.
